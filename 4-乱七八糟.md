<!--
 * @Author: your name
 * @Date: 2021-05-21 09:25:28
 * @LastEditTime: 2021-05-24 09:56:07
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \szjj-monitor-web\src\views\system\behavior-analysis\index.vue
-->
<template>
  <div :class="$style.behavior">
    <section :class="$style.top">
      <div v-for="(item, index) in params" :key="index" :class="$style.topLi">
        <!-- 第一行 -->
        <div :class="$style.topLiTitle">
          <!-- item.name 即当日访问量 -->
          <span :class="$style.name">{{ item.name }}</span>
          <span :class="$style.updateTime">更新时间：昨日 08:00:00 </span>
        </div>
        <!-- 第二行 -->
        <div :class="$style.topLiDesc">
          <!-- 访问量规模 -->
          <div :class="$style.desc">{{ item.desc }}</div>
          <div :class="$style.number">
            <!-- 01 02 03 -->
            {{ item.key }}
          </div>
          <!-- 最后一行 -->
          <div :class="$style.riseDown">较昨日{{ item.percent }}</div>
        </div>
        <div></div>
      </div>
    </section>
    <section :class="$style.bottom">
      <base-grid
        ref="base-grid"
        :columns="columns"
        :api="api"
        :options="options"
        :isShowIndex="true"
        :isShowPagination="true"
        :isSelectedFirstRow="false"
        :paginationAttributes="paginationAttributes"
        @onLoadSuccess="onLoadSuccess"
        :isContinuityIndex="true"
        :isOptionsPage="true"
      >
        <template v-slot:search>
          <div :class="$style.search">
            <div>
              <span :class="$style.searchLabel">用户姓名</span
              ><el-input v-model="queryParams.inputValue" />
            </div>
            <div>
              <span :class="$style.searchLabel">所属区域</span>
              <base-select v-model="queryParams.selectValue"></base-select>
            </div>
            <div><el-button type="primary">查询</el-button></div>
          </div>
        </template>
      </base-grid>
    </section>
  </div>
</template>
<script>
export default {
  data() {
    this.api = '';
    return {
      queryParams: {
        selectValue: '',
        value: ''
      },
      paginationAttributes: {
        // layout: 'prev, pager, next, total'
        'current-page': 1, // 设置分页栏为第三页，如果需要在初始化时跳转到不是第1页那么需要和 options.data.pageNum 一起设置
        pageSizes: [5, 10, 20, 30, 50] // 如果 options.data.pageSize 的值不在默认的 [10, 20, 30, 40, 50, 100] 里面，分页会失效需要手动给定一个数组
      },
      options: {
        code: '0000',
        message: '',
        data: {
          pageNum: 1, // 加载第三页的数据
          pageSize: 10, // 一页显示5条数据，5在默认的 pageSizes 中不存在，所以需要定义 paginationAttributes.pageSizes
          results: [],
          totalPage: 0,
          totalRecord: 0
        },
        timestamp: Date.parse(new Date())
      },
      dataList: [{ name: '11', role: '222', area: '11', time: '11' }],
      columns: [
        { label: '用户姓名', prop: 'name' },
        { label: '用户角色', prop: 'role' },
        { label: '所属区域', prop: 'area' },
        { label: '累计访问时长', prop: 'time' },
        {
          label: '操作',
          slotNode: [
            {
              render: (h, row, column, index) => {
                return h(
                  'el-button',
                  {
                    props: { type: 'text', size: 'size' },
                    on: {
                      click: event => {
                        this.createDialog();
                        console.info(event, row, column, index);
                      }
                    }
                  },
                  ['用户行为分析']
                );
              }
            }
          ]
        }
      ],
      params: [
        { name: '当日访问量', desc: '访问量规模', key: '01', percent: 'a' },
        { name: '当日访客量', desc: '访客量规模', key: '02', percent: 'a' },
        { name: '平均访问时长', desc: '访问时长统计', key: '03', percent: 'a' }
      ],
      showDialog: true
    };
  },
  created() {
    setTimeout(this.setOptions, 500);
  },
  methods: {
    setOptions() {
      const results = [];
      this.dataList.forEach((v, i) => {
        const obj = v;
        obj.id = i + 1;
        results.push(obj);
      });
      this.options.data.totalPage = Math.ceil(
        results.length / this.options.data.pageSize
      ); // 总页数
      this.options.data.totalRecord = results.length;
      this.options.data.results = results;
    },

    onLoadSuccess(data) {
      // console.info('数据加载完成 ', data);
    },
    onSearch() {
      this.$refs['base-grid'].reloadGrid();
    },
    createDialog() {}

}
};
</script>

<style lang="less" module>
:global .el-input {
  width: 241px;
}

.top {
  .flex;

  box-sizing: border-box;
  margin-bottom: 20px;
  &-li {
    width: calc((100% - 68px) / 3);
    height: 348px;
    padding: 24px;
    margin-right: 20px;
    .bg-fff;
    &:last-child {
      margin-right: 0;
    }
    &-title {
      margin-bottom: 24px;
      font-size: 12px;
      .name {
        font-size: 16px;
        color: rgba(17, 17, 17, 100);
      }
      .update-time {
        margin-left: 21px;
        color: rgba(153, 153, 153, 100);
      }
    }
    &-desc {
      .desc {
        margin-bottom: 6px;
        font-size: 14px;
        color: rgba(51, 51, 51, 100);
      }
      .number {
        margin-bottom: 8px;
        font-size: 32px;
        color: rgba(17, 17, 17, 100);
      }
      .rise-down {
        font-size: 12px;
        color: rgba(153, 153, 153, 100);
      }
    }
  }
}
.bottom {
  .search {
    .flex;

    margin-bottom: 17px;
    &-label {
      margin-right: 10px;
      white-space: nowrap;
    }
    > div {
      .flex;

      align-items: center;
      margin-right: 42px;
    }
  }
}
.behavior {
  .full-y;

  .bottom {
    .bg-fff;

    box-sizing: border-box;
    padding: 26px 0 31px 24px;
  }
}
</style>

// 用户子页面
// .user {
//   .flex;

//   box-sizing: border-box;
//   height: 160px;
//   padding: 40px 60px;
//   margin-top: 10px;
//   margin-bottom: 24px;
//   .bg-fff;

//   .portrait {
//     width: 78px;
//     height: 78px;
//     margin-left: 6px;
//     background-color: rgb(218, 197, 197);
//   }
//   .details {
//     .flex-column-center;

//     width: 78px;
//     height: 78px;
//     margin-right: 376px;
//     margin-left: 36px;
//     font-size: 14px;
//     background-color: rgb(218, 197, 197);
//     .name {
//       margin-bottom: 12px;
//     }
//   }
//   &-li {
//     height: 80px;
//     margin-right: 100px;
//     .bg-fff;
//     &:last-child {
//       margin-right: 0;
//     }
//     .average {
//       font-size: 16px;
//       color: rgba(17, 17, 17, 100);
//     }
//     .time {
//       font-size: 32px;
//     }
//     .rise-down {
//       .flex-start-center;

//       font-size: 12px;
//       color: rgba(153, 153, 153, 100);
//     }
//     .arrow {
//       // width: 14px;
//       // height: 20px;
//       margin-right: 6px;
//       margin-left: 6px;

//       /* background: rgb(253, 253, 253) url('~@static/images/user/pic2.png')
//         no-repeat 50%;
//       background-size: cover; */
//     }
//   }
// }
